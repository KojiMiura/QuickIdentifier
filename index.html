<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        #myProgress {
        width: 100%;
        background-color: #ddd;
        visibility: hidden;
    }

    #myBar {
        width: 1%;
        height: 50px;
        background-color: #4CAF50;
        visibility: hidden;
    }

    #msg {
	visibility: hidden;
    }
    </style>
    <title>MediaDevices.getUserMedia()</title>
</head>
<body>

<button onclick="startVideo()">スタート</button>
<button onclick="stopVideo()">ストップ</button>
<button onclick="takePhoto()">機種 自動判別</button>
<button onclick="takePhoto2()">エラー 自動判別</button>

<h2>カメラ</h2>
<p>プリンター機能判別</p>
<p>プリンタデザインから機種、LED点滅パターンからエラーを判定します</p>
<video autoplay id=videoView width="512" height="512"></video>

<h2 id="msg">Model Identifying...</h2>
<img id=imageView/>

<canvas style="display: none" width="512" height="512"></canvas>

<div id="myProgress">
<div id="myBar"></div>
</div>

<script src="app.js"></script>

<script>

function startCamera() {
	document.getElementById("videoView").hidden=false;
	startVideo()
}

function takePhoto() {
	snapshot();
	
	document.getElementById("videoView").hidden=true

	document.getElementById("msg").style.visibility="visible";

  	var elem0 = document.getElementById("myProgress");
  	elem0.style.visibility="visible";
  
  	var elem = document.getElementById("myBar");   
  	elem.style.visibility="visible";
  
  	var width = 1;
  	var id = setInterval(frame, 10);
  
  	function frame() {
    		if (width >= 100) {
      			clearInterval(id);
			document.getElementById("msg").style.visibility="hidden";
			location.href = "https://youtu.be/3n5MM0emgg4"; // Air-REGI Youtube へジャンプ
      			//disp();
    		} else {
      			width++; 
      			elem.style.width = width + '%'; 
    		}
  	}
}

function takePhoto2() {
	document.getElementById("msg").style.visibility="visible";

	var elem0 = document.getElementById("myProgress");
  	elem0.style.visibility="visible";
  
  	var elem = document.getElementById("myBar");   
  	elem.style.visibility="visible";
  
  	var width = 1;
  	var id = setInterval(frame, 10);
  
  	function frame() {
    		if (width >= 100) {
      			clearInterval(id);
			document.getElementById("msg").style.visibility="hidden";
      			disp2();
    		} else {
      			width++; 
      			elem.style.width = width + '%'; 
    		}
  	}
}

function disp(){

	// 「OK」時の処理開始 ＋ 確認ダイアログの表示
	if(window.confirm('TSP650II？')){

		location.href = "https://youtu.be/3n5MM0emgg4"; // Air-REGI Youtube へジャンプ
		//location.href = "http://www.star-m.jp/eng/products/s_print/sp01_08.html"; // SMA TSP650II へジャンプ

	}
	// 「OK」時の処理終了

	// 「キャンセル」時の処理開始
	else{

		window.alert('キャンセルされました'); // 警告ダイアログを表示

	}
	// 「キャンセル」時の処理終了
}

function disp2(){

	// 「OK」時の処理開始 ＋ 確認ダイアログの表示
	if(window.confirm('用紙がありません！ 用紙を交換してください')){

		location.href = "https://faq.airpayment.jp/hc/ja/articles/220037347-%E3%83%AC%E3%82%B7%E3%83%BC%E3%83%88%E3%83%97%E3%83%AA%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%8C%E6%95%85%E9%9A%9C%E3%81%8B%E3%81%AA-%E3%81%A8%E6%84%9F%E3%81%98%E3%81%9F%E3%82%89#01";
		//location.href = "http://www.star-m.jp/eng/products/s_print/sp01_08.html"; // SMA TSP650II へジャンプ

	}
	// 「OK」時の処理終了

	// 「キャンセル」時の処理開始
	else{

		window.alert('キャンセルされました'); // 警告ダイアログを表示

	}
	// 「キャンセル」時の処理終了
}

</script>
</body>
</html>
